import{_ as U,T as x,S as k}from"./index-24b5c249.js";import{r as m,o as i,a as l,b as t,d as u,w as v,C as g,M as N,v as C,x as f,y as _,O as L,L as y,e as h,K as n}from"./calendar.esm-ab6b2a00.js";class M{getProductsSmall(){return fetch("@/data/products-small.json").then(s=>s.json()).then(s=>s.data)}}const c="https://stage.westar-cms.com/v1/user",V={name:"Staff",components:{TopHeader:x,Sidebar:k},data(){return{products:[],tempProduct:{},dataAll:[],apiListLength:0,index:0,user:[],users:[],userId:"",isNew:!1,selectedUser:null,items:[],userIds:[],saveUserId:null,saveUserIdSelected:{userName:"",password:"",identity:""},isEditingStaff:!1,editStaff:{userName:"",password:"",identity:""},staff:{},isLoading:!0}},productService:null,created(){this.productService=new M},methods:{getUsers(){const e=this;this.$http.get(c).then(s=>{e.isLoading=!1,s.data.data.list,this.products=s.data.data.list,this.apiListLength=s.data.data.list,this.userId="res.data.data.list[0].userId",this.users=s.data.data.list,this.user=this.users.find(o=>o.userId===this.userId)})},getStaffInfo(){this.$http.get(`api/?userId=${this.dataAll.id}`).then(e=>{const s=e.data.data.list;this.userName=s.userName,this.email=s.email,this.password=s.password,this.identity=s.identity,console.log(s)})},saveUserIdClick(e){this.saveUserId=e;const s=this.saveUserIdSelected;this.saveUserIdSelected=this.products.find(o=>o.userId===e),this.isEditingStaff=!0,this.editStaff.userName=s.userName,this.editStaff.password=s.password,this.editStaff.identity=s.identity},editStaffClick(e){this.staff=e,this.$http.get(c+`/?userId=${this.saveUserId}`,{data:{userName,password,identity}}).then(s=>{}).catch(s=>{console.log(s.data.result.message)})},async updateStaff(){try{(await this.axios.patch(c+`/?userId=${this.saveUserId}`,{userName:this.saveUserIdSelected.userName,password:this.saveUserIdSelected.password,identity:this.saveUserIdSelected.identity})).data.result.code===230?(this.$swal({title:"更新成功",icon:"success",showConfirmButton:!1,timer:1500}),this.getUsers()):(this.$swal({title:"更新失敗",icon:"warning",showConfirmButton:!1,timer:1500}),this.getUsers())}catch(e){console.log(e.data)}},async getStaff(){await this.$http.get(c,{data:{userName:this.editStaff.userName,password:this.editStaff.password,identity:this.editStaff.identity}})},delStaff(){this.$http.delete(c,{data:{userId:this.saveUserId}}).then(e=>{e.data.result.code===240?(this.$swal({title:"刪除成功",icon:"success",showConfirmButton:!1,timer:1500}),this.getUsers()):this.$swal({title:"刪除失敗",icon:"warning",showConfirmButton:!1,timer:1500})}).catch(e=>{console.log(e)})},findIndexById(e){let s=-1;for(let o=0;o<this.products.length;o++)if(this.products[o].userId===e){s=o;break}return s},getIndex(e){return this.products.findIndex(s=>s.id==e)}},mounted(){this.getUsers(),this.getStaff(),this.saveUserIdClick()}},B={class:"wrapper"},j={class:"page-content-wrapper"},E={class:"container-fluid"},T={class:"row"},$={class:"col-lg-12"},P={class:"bg-light pt-2 pb-2 rounded","aria-label":"breadcrumb"},q={class:"breadcrumb d-flex align-items-center mb-0 px-2"},H=t("li",{class:"breadcrumb-item active","aria-current":"page"}," 人員管理 ",-1),A=t("div",null,[t("h2",{class:"text-primary mt-4 fs-3 fw-bold"},[t("span",null,[t("i",{class:"bi bi-people-fill fs-3 text-secondary"})]),h(" 人員管理 ")])],-1),D={class:"col-12 mt-4 mb-2"},F={class:"d-flex justify-content-between"},K=t("h4",{class:"fs-5"},"帳號列表",-1),O=t("i",{class:"bi bi-person-fill-add"},null,-1),z={class:"col-lg-12"},G={class:"table-responsive"},J={class:"table table-bordered align-middle"},Q=t("thead",{class:"table-primary"},[t("tr",null,[t("th",{scope:"col"},"#"),t("th",{scope:"col"},"姓名"),t("th",{scope:"col"},"帳號"),t("th",{scope:"col"},"密碼"),t("th",{scope:"col"},"身分"),t("th",{scope:"col"},"操作")])],-1),R={class:"table-group-divider"},W={scope:"row"},X={key:0},Y={key:1},Z=["id","onClick"],tt=t("i",{class:"bi bi-pencil-fill"},null,-1),st=["onClick"],et=t("i",{class:"bi bi-trash-fill"},null,-1),dt={class:"modal fade modal-lg",id:"editModal",tabindex:"-1","aria-labelledby":"editModalLabel","aria-hidden":"true"},at={class:"modal-dialog"},ot={class:"modal-content"},it=t("div",{class:"modal-header border-bottom-0"},[t("h1",{class:"modal-title fs-5 text-primary",id:"editModalLabel"}," 編輯資料 "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),lt={class:"modal-body text-center"},rt={class:"row card-group"},nt={class:"col-md-12 mb-4"},ct={key:0,class:"col-md-12"},ht={class:"col-md-6 mb-3 text-start"},ut=t("label",{for:"staffUserName",class:"form-label"},"姓名",-1),ft={class:"col-md-6 mb-3 text-start"},mt=t("label",{for:"staffEmail",class:"form-label"},"帳號",-1),_t={class:"col-md-6 mb-2 text-start"},bt=t("label",{for:"staffPassword",class:"form-label"},"密碼",-1),pt={class:"col-md-6 mb-2 text-start"},vt=t("label",{for:"idSelected",class:"form-label"},"身份",-1),gt=t("option",{value:"最高管理者"},"最高管理者",-1),yt=t("option",{value:"一般管理者"},"一般管理者",-1),St=[gt,yt],wt={key:1,class:"d-none"},It={class:"modal-footer d-flex justify-content-center border-top-0 mb-4"},Ut={class:"col-12"},xt={class:"d-flex justify-content-center"},kt={class:"modal fade",id:"delModal",tabindex:"-1","aria-labelledby":"delModalLabel","aria-hidden":"true"},Nt={class:"modal-dialog"},Ct={class:"modal-content"},Lt=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"delModalLabel"},"刪除資料"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Mt=t("div",{class:"modal-body text-center"},"確認要刪除這筆資料?",-1),Vt={class:"modal-footer d-flex justify-content-center"},Bt=t("button",{type:"button",class:"btn btn-light","data-bs-dismiss":"modal"}," 取消 ",-1);function jt(e,s,o,Et,a,r){const S=m("Sidebar"),w=m("TopHeader"),b=m("router-link");return i(),l(g,null,[t("div",B,[u(S),t("div",j,[t("div",E,[t("div",T,[t("section",$,[u(w),t("nav",P,[t("ol",q,[u(b,{to:"/dshboard",class:"breadcrumb-item"},{default:v(()=>[h("首頁")]),_:1}),H])]),A,t("div",D,[t("div",F,[K,u(b,{to:"/staff-add",class:"btn btn-secondary text-light"},{default:v(()=>[O,h(" 新增人員")]),_:1})])])]),t("div",z,[t("div",G,[t("table",J,[Q,t("tbody",R,[(i(!0),l(g,null,N(a.products,(d,p)=>(i(),l("tr",{key:p},[t("th",W,n(p+1),1),t("td",null,n(d.userName),1),d.email!=""?(i(),l("td",X,n(d.email),1)):d.email.length=="0"?(i(),l("td",Y,"NULL")):y("",!0),t("td",null,n(d.password),1),t("td",null,n(d.identity),1),t("td",null,[t("button",{type:"button",class:"btn btn-primary text-white me-2","data-bs-toggle":"modal","data-bs-target":"#editModal",id:d.userId,onClick:I=>r.saveUserIdClick(d.userId)},[tt,h(" 編輯 ")],8,Z),t("button",{type:"button",class:"btn btn-danger","data-bs-toggle":"modal","data-bs-target":"#delModal",onClick:I=>r.saveUserIdClick(d.userId)},[et,h(" 刪除 ")],8,st)])]))),128))])])])])])])])]),t("div",dt,[t("div",at,[t("div",ot,[it,t("div",lt,[t("div",rt,[t("div",nt,[a.isEditingStaff?(i(),l("div",ct,[a.saveUserIdSelected?(i(),l("form",{key:0,class:"row fs-6 p-4",onSubmit:s[4]||(s[4]=C(d=>r.editStaffClick(),["prevent"]))},[t("div",ht,[ut,f(t("input",{type:"text",class:"form-control",id:"staffUserName","onUpdate:modelValue":s[0]||(s[0]=d=>a.saveUserIdSelected.userName=d),required:""},null,512),[[_,a.saveUserIdSelected.userName]])]),t("div",ft,[mt,f(t("input",{type:"email",class:"form-control",id:"staffEmail","onUpdate:modelValue":s[1]||(s[1]=d=>a.saveUserIdSelected.email=d),disabled:""},null,512),[[_,a.saveUserIdSelected.email]])]),t("div",_t,[bt,f(t("input",{type:"text",class:"form-control",id:"staffPassword","onUpdate:modelValue":s[2]||(s[2]=d=>a.saveUserIdSelected.password=d),required:""},null,512),[[_,a.saveUserIdSelected.password]])]),t("div",pt,[vt,f(t("select",{class:"form-select","aria-label":"idSelected","onUpdate:modelValue":s[3]||(s[3]=d=>a.saveUserIdSelected.identity=d),required:""},St,512),[[L,a.saveUserIdSelected.identity]])])],32)):y("",!0)])):(i(),l("div",wt))])])]),t("div",It,[t("div",Ut,[t("div",xt,[t("button",{type:"submit",class:"btn btn-primary text-light","data-bs-dismiss":"modal",onClick:s[5]||(s[5]=d=>r.updateStaff())}," 確認資料 ")])])])])])]),t("div",kt,[t("div",Nt,[t("div",Ct,[Lt,Mt,t("div",Vt,[Bt,t("button",{type:"button",class:"btn btn-primary text-white",onClick:s[6]||(s[6]=d=>r.delStaff()),"data-bs-dismiss":"modal"}," 確認 ")])])])])],64)}const Pt=U(V,[["render",jt]]);export{Pt as default};
